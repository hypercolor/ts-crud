{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./index.ts","webpack:///./src/crud-config.ts","webpack:///./src/crud-handlers.ts","webpack:///./src/crud-routes.ts","webpack:///./src/handlers/get/get-all-objects-handler.ts","webpack:///./src/handlers/handler.ts","webpack:///./src/handlers/shared/create-object-from-json.ts","webpack:///./src/handlers/shared/fetch-object.ts","webpack:///./src/handlers/shared/update-object-from-json.ts","webpack:///./src/promise_queue.ts","webpack:///external \"p-queue\"","webpack:///external \"ts-express-controller\""],"names":[],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(global, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading wasm modules\n \tvar installedWasmModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// object with all compiled WebAssembly.Modules\n \t__webpack_require__.w = {};\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import { PatchByIdRoute } from \"./src/crud-routes\";\n\nexport {GetRoute, PostRoute, DeleteRoute, MarkDeletedRoute, MarkUndeletedRoute, MultiPutRoute, MultiPatchRoute, PutByIdRoute, QueryRoute, PatchByIdRoute} from './src/crud-routes';\nexport {IUserRequest} from './src/IUserRequest';\nexport {CrudHandlers} from './src/crud-handlers';\nexport {CrudConfig} from './src/crud-config';\n","import { ControllerConfig } from \"ts-express-controller\";\n\nexport class CrudConfig {\n  public static setControllerConfig(name: string, description: string, version: string){\n    ControllerConfig.packageConfig.packageName = name;\n    ControllerConfig.packageConfig.packageDescription = description;\n    ControllerConfig.packageConfig.packageVersion = version;\n  }\n\n}\n","\n\nimport {Collection} from 'bookshelf';\nimport {Transaction} from 'knex';\n// import {IUserRequest} from '../../util/auth';\n// import * as e from \"express\";\nimport { IPostgresModelClass, PostgresModel } from \"ts-postgres-model\";\nimport {PromiseQueue} from './promise_queue';\nimport { IUserRequest } from \"./IUserRequest\";\nimport { EUpdateType, UpdateObjectFromJson } from \"./handlers/shared/update-object-from-json\";\nimport { CreateObjectFromJson } from \"./handlers/shared/create-object-from-json\";\nimport { FetchObject } from \"./handlers/shared/fetch-object\";\n\n\n\nexport class CrudHandlers {\n\n\n\n\n  public static postFromRequestBody<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>) {\n    if (req.body.constructor === Array) {\n      const queue = new PromiseQueue(1);\n      return queue.runAllPromiseFunctions(req.body.map((jsonObject: any) => {\n        return () => {\n          return new CreateObjectFromJson(model, jsonObject, req).run();\n        };\n      }));\n    } else {\n      return new CreateObjectFromJson(model, req.body, req).run();\n    }\n  }\n\n  public static getObjectById<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>, objectId: number): Promise<T> {\n    return new FetchObject(req, model, objectId, true).run()\n    .then((object: T) => {\n      if (object === null) {\n        return Promise.reject({code: 404, error: model.instanceName + ' not found: ' + objectId});\n      } else {\n        return Promise.resolve(object);\n      }\n    });\n  }\n\n\n  public static putObject<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>, objectId: number, transaction?: Transaction) {\n    req.body.id = objectId;\n    return new UpdateObjectFromJson(model, req.body, req, EUpdateType.PUT, transaction).run();\n  }\n\n\n  public static patchObject<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>, objectId: number, transaction?: Transaction) {\n    req.body.id = objectId;\n    return new UpdateObjectFromJson(model, req.body, req, EUpdateType.PATCH, transaction).run();\n  }\n\n  public static putObjects<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>, transaction?: Transaction): Promise<T | Collection<T>> {\n    if (req.body.constructor === Array) {\n      const queue = new PromiseQueue(1);\n      return queue.runAllPromiseFunctions(req.body.map((jsonObject: any) => {\n        return () => {\n          return new UpdateObjectFromJson(model, jsonObject, req, EUpdateType.PUT, transaction).run();\n        };\n      }));\n    } else {\n      return new UpdateObjectFromJson(model, req.body, req, EUpdateType.PUT, transaction).run();\n    }\n  }\n\n  public static patchObjects<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>, transaction?: Transaction): Promise<T | Collection<T>> {\n    if (req.body.constructor === Array) {\n      const queue = new PromiseQueue(1);\n      return queue.runAllPromiseFunctions(req.body.map((jsonObject: any) => {\n        return () => {\n          return new UpdateObjectFromJson(model, jsonObject, req, EUpdateType.PATCH, transaction).run();\n        };\n      }));\n    } else {\n      return new UpdateObjectFromJson(model, req.body, req, EUpdateType.PATCH, transaction).run();\n    }\n  }\n\n  public static deleteObject<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>, objectId: number) {\n    let object;\n    return new FetchObject(req, model, objectId, false).run()\n    .then((o: T) => {\n      object = o;\n      if (object === null) {\n        return Promise.reject({code: 404, error: model.instanceName + ' not found: ' + objectId});\n      } else {\n        return object.destroyForUser(req.user);\n      }\n    })\n    .then(() => {\n      return Promise.resolve();\n    });\n  }\n\n  public static setObjectDeleted<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>, objectId: number) {\n    return new FetchObject(req, model, objectId, false).run()\n    .then((object: T) => {\n      if (object === null) {\n        return Promise.reject({code: 404, error: model.instanceName + ' not found: ' + objectId});\n      } else {\n        object.deleted = true;\n        return object.saveForUser(req.user);\n      }\n    });\n  }\n\n  public static setObjectUndeleted<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>, objectId: number) {\n    return new FetchObject(req, model, objectId, false).run()\n    .then((object: T) => {\n      if (object === null) {\n        return Promise.reject({code: 404, error: model.instanceName + ' not found: ' + objectId});\n      } else {\n        object.deleted = false;\n        return object.saveForUser(req.user);\n      }\n    });\n  }\n\n  // public static fetchObjectForRequest<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>, id: number, fetchParams?: any) {\n  //   const query = new model().where({id});\n  //   return query.fetchForUser(req.user, fetchParams);\n  // }\n}\n\n\n/**\n * Worker method for PUT\n *\n * @param model\n * @param jsonObject\n * @param req\n * @param transaction\n * @returns {Promise|*}\n */\n// export function handlePutForJsonObject<T extends PostgresModel<T>>(model: IPostgresModelClass<T>, jsonObject: any, req: IUserRequest, transaction?: Transaction): Promise<T> {\n//   if (jsonObject.id === undefined || jsonObject.id === '') {\n//     return handlePostForJsonObject(model, jsonObject, req);\n//   } else {\n//     return fetchObjectForRequest(req, model, jsonObject.id)\n//     .then(object => {\n//       if (object === null) {\n//         return Promise.reject({code: 404, error: model.instanceName + ' not found: ' + jsonObject.id});\n//       } else {\n//         if (transaction){\n//           return object.updateWithParams(jsonObject,req, {transacting: transaction});\n//         } else {\n//           return object.updateWithParams(jsonObject,req);\n//         }\n//       }\n//     })\n//     .then(object => {\n//       if (req.query.p === undefined) {\n//         return Promise.resolve(object);\n//       } else {\n//         return validateFetchOptions(model, req.query.p)\n//         .then((fetchOptions: any) => {\n//           return new model().where({id: object.id}).fetchForUser(req, {withRelated: fetchOptions});\n//         });\n//       }\n//     });\n//   }\n// }\n\n/**\n * Worker method for POST\n *\n * @param model\n * @param jsonObject\n * @param req\n * @returns {Promise|*}\n */\n// function handlePostForJsonObject<T extends PostgresModel<T>>(model: IPostgresModelClass<T>, jsonObject: any, req: IUserRequest) {\n//   // if (!req.user){\n//   //   return Promise.reject({code: 500, error: 'Request had no user.'});\n//   // } else {\n//     jsonObject = jsonObject || {};\n//     // if (((new model().columns) as any)['userId']) {\n//     //   jsonObject.userId = jsonObject.userId || req.user.id;\n//     // }\n//     const object = new model();\n//     return object.updateWithParams(jsonObject, req.user)\n//     .then(savedObject => {\n//       if (req.query.p === undefined) {\n//         return Promise.resolve(savedObject);\n//       } else {\n//         return validateFetchOptions(model, req.query.p)\n//         .then((fetchOptions: any) => {\n//           return new model().where({id: object.id}).fetchForUser(req.user, {withRelated: fetchOptions});\n//         });\n//       }\n//     });\n//   // }\n// }\n\n/**\n * Fetch an object for a req.\n *\n * @param req\n * @param model\n * @param id\n * @param [fetchParams] - Fetch options\n * @returns {*|Promise.<Model|null>}\n */\n// export function fetchObjectForRequest<T extends PostgresModel<T>>(req: IUserRequest, model: IPostgresModelClass<T>, id: number, fetchParams?: any) {\n//   let query = new model().where({id});\n//   return query.fetchForUser(req, fetchParams);\n// }\n\n","\n\n// import {PostgresModel, IPostgresModelClass} from '../../models/shared/base';\n// import {IUserRequest} from '../../util/auth';\n// import {Controller, Response} from './base';\nimport {CrudHandlers} from './crud-handlers';\nimport { IUserRequest } from \"./IUserRequest\";\nimport { IPostgresModelClass, PostgresModel } from \"ts-postgres-model\";\nimport {Controller} from 'ts-express-controller';\nimport {Response} from 'express';\nimport { GetAllObjectsHandler } from \"./handlers/get/get-all-objects-handler\";\n\n/**\n * Default GET by ID\n */\nexport class GetRoute extends Controller {\n  constructor(private _type: IPostgresModelClass<any>, private idParamName: string) {super({\n    routeParams: [idParamName]\n  });}\n  protected handleRequest(params: any, req: IUserRequest, res: Response) {\n    return CrudHandlers.getObjectById(req, this._type, params[this.idParamName]);\n  }\n}\n\n\n/**\n * Default POST from request JSON body\n */\nexport class PostRoute extends Controller {\n  constructor(private _type: IPostgresModelClass<any>) {super();}\n  protected handleRequest(params: any, req: IUserRequest, res: Response) {\n    return CrudHandlers.postFromRequestBody(req, this._type);\n  }\n}\n\n/**\n * Default PUT by ID from request JSON body\n */\nexport class PutByIdRoute<T extends PostgresModel<T>> extends Controller {\n  constructor(private _type: IPostgresModelClass<any>, private idParamName: string) {super({\n    routeParams: [idParamName]\n  });}\n  protected handleRequest(params: any, req: IUserRequest, res: Response) {\n    return CrudHandlers.putObject(req, this._type, params[this.idParamName]);\n  }\n}\n\n/**\n * Default PATCH by ID from request JSON body\n */\nexport class PatchByIdRoute<T extends PostgresModel<T>> extends Controller {\n  constructor(private _type: IPostgresModelClass<any>, private idParamName: string) {super({\n    routeParams: [idParamName]\n  });}\n  protected handleRequest(params: any, req: IUserRequest, res: Response) {\n    return CrudHandlers.patchObject(req, this._type, params[this.idParamName]);\n  }\n}\n\n/**\n * Default PUT by ID from request JSON body\n */\nexport class MultiPutRoute<T extends PostgresModel<T>> extends Controller {\n  constructor(private _type: IPostgresModelClass<any>) {super();}\n  protected handleRequest(params: any, req: IUserRequest, res: Response) {\n    return CrudHandlers.putObjects(req, this._type);\n  }\n}\n\n/**\n * Default PUT by ID from request JSON body\n */\nexport class MultiPatchRoute<T extends PostgresModel<T>> extends Controller {\n  constructor(private _type: IPostgresModelClass<any>) {super();}\n  protected handleRequest(params: any, req: IUserRequest, res: Response) {\n    return CrudHandlers.patchObjects(req, this._type);\n  }\n}\n\n/**\n * Default DELETE by ID\n */\nexport class DeleteRoute extends Controller {\n  constructor(private _type: IPostgresModelClass<any>, private idParamName: string) {super({\n    routeParams: [idParamName]\n  });}\n  protected handleRequest(params: any, req: IUserRequest, res: Response) {\n    return CrudHandlers.deleteObject(req, this._type, params[this.idParamName]);\n  }\n}\n\n/**\n * Default Query for all objects of a type\n */\nexport class QueryRoute extends Controller {\n  constructor(private _type: IPostgresModelClass<any>, private fetchParams?: any, private _allowDeleted?: boolean) {super();}\n  protected handleRequest(params: any, req: IUserRequest, res: Response) {\n    return new GetAllObjectsHandler(req, this._type, this.fetchParams, this._allowDeleted).run();\n  }\n}\n\n\nexport class MarkDeletedRoute extends Controller {\n  constructor(private _type: IPostgresModelClass<any>, private idParamName: string) {super({\n    routeParams: [idParamName]\n  });}\n  protected handleRequest(params: any, req: IUserRequest, res: Response) {\n    return CrudHandlers.setObjectDeleted(req, this._type, params[this.idParamName]);\n  }\n}\n\nexport class MarkUndeletedRoute extends Controller {\n  constructor(private _type: IPostgresModelClass<any>, private idParamName: string) {super({\n    routeParams: [idParamName]\n  });}\n  protected handleRequest(params: any, req: IUserRequest, res: Response) {\n    return CrudHandlers.setObjectUndeleted(req, this._type, params[this.idParamName]);\n  }\n}\n\n","import { IPostgresModelClass, PostgresModel } from \"ts-postgres-model\";\nimport { IUserRequest } from \"../../IUserRequest\";\nimport { Handler } from \"../handler\";\n\nexport class GetAllObjectsHandler<T extends PostgresModel<T>> extends Handler {\n\n  constructor(private req: IUserRequest, private model: IPostgresModelClass<T>, private fetchParams: any, private allowDeleted: boolean | undefined){\n    super()\n  }\n\n  run() {\n    const query = this.allowDeleted ? {} : {deleted: false};\n    return new this.model().where(query).fetchAllForUser(this.req.user, this.fetchParams)\n    .then(objects => {\n      return Promise.resolve(objects.toJSON());\n    });\n  }\n}\n","export abstract class Handler {\n  abstract run(): Promise<any>;\n}\n","import { Handler } from \"../handler\";\nimport { IPostgresModelClass, PostgresModel } from \"ts-postgres-model\";\nimport { IUserRequest } from \"../../IUserRequest\";\nimport { FetchObject } from \"./fetch-object\";\n\nexport class CreateObjectFromJson<T extends PostgresModel<T>> extends Handler {\n\n  constructor(private model: IPostgresModelClass<T>, private jsonObject: any, private req: IUserRequest){\n    super();\n\n    this.jsonObject = jsonObject || {};\n  }\n\n  run() {\n\n    const object = new this.model();\n    return object.updateWithParams(this.jsonObject, this.req.user)\n    .then(savedObject => {\n      if (this.req.query.p === undefined) {\n        return Promise.resolve(savedObject);\n      } else {\n        return new FetchObject(this.req, this.model, this.jsonObject.id, true).run();\n      }\n    });\n  }\n}\n","import { Handler } from \"../handler\";\nimport { IPostgresModelClass, PostgresModel } from \"ts-postgres-model\";\nimport { IUserRequest } from \"../../IUserRequest\";\n\nexport class FetchObject<T extends PostgresModel<T>> extends Handler {\n\n  constructor(private req: IUserRequest, private model: IPostgresModelClass<T>, private objectId: number, private allowQueryPopulation: boolean, private fetchParams?: any){\n    super();\n\n    this.fetchParams = fetchParams || {};\n\n    if (!this.fetchParams.withRelated) {\n      this.fetchParams.withRelated = [];\n    }\n  }\n\n\n  run() {\n\n    if (this.allowQueryPopulation) {\n      return validateFetchOptions(this.model, this.req.query.p)\n      .then((fetchOptions: Array<string>) => {\n        fetchOptions.forEach(option => {\n          this.fetchParams.withRelated.push(option);\n        });\n        return this.doQuery();\n      });\n    } else {\n      return this.doQuery();\n    }\n\n\n\n  }\n\n  private doQuery() {\n    return new this.model().where({id: this.objectId}).fetchForUser(this.req.user, this.fetchParams);\n  }\n\n}\n\n\n\n/**\n * Validate the fetch parameters specified in population-enabled routes.\n *\n * @param model\n * @param fetchOptionsString\n * @returns {*}\n */\nfunction validateFetchOptions<T extends PostgresModel<T>>(model: IPostgresModelClass<T>, fetchOptionsString: string): Promise<Array<string>> {\n  // console.log(\"Validating fetch options for \" + model.model.MODEL_NAME + \": \" + fetchOptionsString);\n\n  if (!fetchOptionsString) {\n    return Promise.resolve([])\n  } else {\n    return parseFetchOptions(fetchOptionsString)\n    .then(fetchOptions => {\n      if (typeof fetchOptions === 'string') {\n        if (!isValidRelationship(model, fetchOptions)) {\n          return Promise.reject({\n            code: 400,\n            error: 'Invalid population for ' + model.constructor.name + ': ' + fetchOptions\n          });\n        } else {\n          return Promise.resolve([fetchOptions]);\n        }\n      } else {\n        return Promise.all(fetchOptions.map(fetchOption => {\n          if (!isValidRelationship(model, fetchOption)) {\n            return Promise.reject({\n              code: 400,\n              error: 'Invalid population for ' + model.constructor.name + ': ' + fetchOption\n            });\n          } else {\n            return Promise.resolve();\n          }\n        }))\n        .then(() => {\n          return Promise.resolve(fetchOptions);\n        });\n      }\n    });\n\n  }\n\n\n  function isValidRelationship(testModel: IPostgresModelClass<T>, testRelationship: string) {\n    if (!testModel.relationships) {\n      return false;\n    } else {\n      let isValid = false;\n      Object.values(testModel.relationships).forEach(relationship => {\n        if (relationship === testRelationship) {\n          isValid = true;\n        }\n      });\n      return isValid;\n    }\n  }\n}\n\n/**\n * Convert a fetch options string from the URL into a JSON object.\n *\n * @param fetchOptionsString\n * @returns {*}\n */\nfunction parseFetchOptions(fetchOptionsString: string): Promise<string | Array<string>> {\n  return new Promise((resolve, reject) => {\n    try {\n      const options = JSON.parse(fetchOptionsString);\n      if (options.constructor !== String && options.constructor !== Array) {\n        reject('Invalid JSON type for fetch options: ' + options.constructor.name);\n      } else {\n        resolve(options);\n      }\n    } catch (err) {\n      reject('Invalid JSON for fetch options: ' + fetchOptionsString + ' - ' + err.message);\n    }\n  });\n}\n","import { Handler } from \"../handler\";\nimport { IPostgresModelClass, PostgresModel } from \"ts-postgres-model\";\nimport { Transaction } from \"knex\";\nimport { IUserRequest } from \"../../IUserRequest\";\nimport { CreateObjectFromJson } from \"./create-object-from-json\";\nimport { FetchObject } from \"./fetch-object\";\n\nexport enum EUpdateType {\n  PUT,\n  PATCH\n}\n\nexport class UpdateObjectFromJson<T extends PostgresModel<T>> extends Handler {\n\n\n  constructor(private model: IPostgresModelClass<T>, private jsonObject: any, private req: IUserRequest, private updateType: EUpdateType, private transaction?: Transaction) {\n    super()\n  }\n\n  run() {\n    if (this.jsonObject.id === undefined || this.jsonObject.id === '') {\n      return new CreateObjectFromJson(this.model, this.jsonObject, this.req).run();\n    } else {\n      return new FetchObject(this.req, this.model, this.jsonObject.id, false).run()\n      .then((object: T) => {\n        if (object === null) {\n          return Promise.reject({code: 404, error: this.model.instanceName + ' not found: ' + this.jsonObject.id});\n        } else {\n\n          // For PUT requests, we want to clear out any existing data, then update from the request\n          if (this.updateType === EUpdateType.PUT) {\n            Object.values(object.columns).forEach(columnName => {\n              delete object[columnName];\n            });\n          }\n\n          if (this.transaction){\n            return object.updateWithParams(this.jsonObject, this.req.user, {transacting: this.transaction});\n          } else {\n            return object.updateWithParams(this.jsonObject, this.req.user);\n          }\n        }\n      })\n      .then((object: T) => {\n        if (this.req.query.p === undefined) {\n          return Promise.resolve(object);\n        } else {\n          return new FetchObject(this.req, this.model, this.jsonObject.id, true).run();\n        }\n      });\n    }\n  }\n\n}\n","\n\nimport * as PQueue from 'p-queue';\n\nexport class PromiseQueue {\n\n  private queue: PQueue;\n\n  constructor(maxConcurrent: number){\n    this.queue = new PQueue({concurrency: maxConcurrent});\n  }\n\n  public add(promiseFunction: () => Promise<any>): Promise<any> {\n    return this.queue.add(promiseFunction);\n  }\n\n  public runAllPromiseFunctions(promiseFunctions: Array<() => Promise<any>>): Promise<any> {\n    if (!promiseFunctions) {\n      return Promise.reject('promiseFunctions was not supplied');\n    } else if (promiseFunctions.length === 0) {\n      return Promise.resolve();\n    } else {\n      const addedPromises: Array<Promise<any>> = [];\n      promiseFunctions.forEach(promiseFunction => {\n        // console.log(\"Adding promiseFunction to queue...\");\n        addedPromises.push(this.add(promiseFunction));\n      });\n\n      return new Promise((resolve, reject) => {\n        Promise.all(addedPromises)\n        .then(results => {\n          // console.log(\"All promises resolved.\");\n          resolve(results);\n        })\n        .catch(err => {\n          // console.log(\"Queue promise failed...\");\n          reject(err);\n        });\n      });\n\n      // return Q.all(addedPromises);\n    }\n  }\n\n}\n\n","module.exports = require(\"p-queue\");","module.exports = require(\"ts-express-controller\");"],"sourceRoot":""}